(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96640,e=>{"use strict";var t=e.i(43476),s=e.i(75157);function a({status:e,className:a}){return(0,t.jsx)("span",{className:(0,s.cn)("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-semibold",(0,s.getStatusColor)(e),a),children:(0,s.getStatusLabel)(e)})}e.s(["default",()=>a])},59544,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75157);let l=(0,s.forwardRef)(({className:e,variant:s="primary",size:l="md",fullWidth:r,loading:i,disabled:n,children:c,...d},o)=>(0,t.jsxs)("button",{ref:o,className:(0,a.cn)("inline-flex items-center justify-center font-semibold transition-all duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-45 disabled:cursor-not-allowed active:scale-[0.98]",{primary:"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-sm focus:ring-blue-500",secondary:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 hover:shadow-sm focus:ring-gray-400",outline:"border-2 border-blue-600 text-blue-600 hover:bg-blue-50 focus:ring-blue-500",ghost:"text-blue-600 hover:bg-blue-50 focus:ring-blue-500",danger:"bg-error text-white hover:opacity-90 hover:shadow-sm focus:ring-red-400",success:"bg-success text-white hover:opacity-90 hover:shadow-sm focus:ring-success"}[s],{sm:"px-3.5 py-1.5 text-[13px]",md:"px-5 py-2.5 text-sm",lg:"px-7 py-3 text-base",xl:"px-9 py-4 text-lg rounded-xl"}[l],r&&"w-full",e),disabled:n||i,...d,children:[i&&(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c]}));l.displayName="Button",e.s(["default",0,l])},22706,e=>{"use strict";var t=e.i(43476);let s=(0,e.i(75254).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);var a=e.i(18566);function l({title:e,subtitle:l,backHref:r,actions:i}){let n=(0,a.useRouter)();return(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[r&&(0,t.jsx)("button",{onClick:()=>n.push(r),className:"p-1.5 rounded-lg hover:bg-gray-100 transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center",children:(0,t.jsx)(s,{className:"w-5 h-5 text-gray-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:e}),l&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:l})]})]}),i&&(0,t.jsx)("div",{className:"flex items-center gap-2",children:i})]})}e.s(["default",()=>l],22706)},39964,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75157);let l=(0,s.forwardRef)(({className:e,hoverable:s,padding:l="md",children:r,...i},n)=>(0,t.jsx)("div",{ref:n,className:(0,a.cn)("bg-white rounded-xl border border-gray-200","shadow-[0_1px_3px_rgba(0,0,0,0.1),0_1px_2px_rgba(0,0,0,0.06)]",{none:"",sm:"p-4",md:"p-5",lg:"p-6"}[l],s&&"hover:shadow-[0_4px_6px_-1px_rgba(0,0,0,0.1),0_2px_4px_-1px_rgba(0,0,0,0.06)] transition-all duration-200 cursor-pointer",e),...i,children:r}));l.displayName="Card",e.s(["default",0,l])},32098,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75157),l=e.i(37727);function r({isOpen:e,onClose:r,title:i,children:n,size:c="md"}){return((0,s.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),e)?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-[rgba(15,23,42,0.5)]",onClick:r}),(0,t.jsxs)("div",{className:(0,a.cn)("relative w-full bg-white rounded-t-xl sm:rounded-xl shadow-[0_20px_25px_-5px_rgba(0,0,0,0.1),0_10px_10px_-5px_rgba(0,0,0,0.04)]","animate-in fade-in zoom-in-95 duration-200","sm:mx-4",{sm:"max-w-sm",md:"max-w-md",lg:"max-w-2xl"}[c]),children:[i&&(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:i}),(0,t.jsx)("button",{onClick:r,className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",children:(0,t.jsx)(l.X,{className:"w-5 h-5 text-gray-400"})})]}),(0,t.jsx)("div",{className:"px-6 py-4",children:n})]})]}):null}e.s(["default",()=>r])},14670,e=>{"use strict";var t=e.i(43476);let s=(0,e.i(75254).default)("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);function a({icon:e,title:a,description:l,action:r}){return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:e||(0,t.jsx)(s,{className:"w-8 h-8 text-gray-400"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:a}),l&&(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-4 max-w-sm",children:l}),r]})}e.s(["default",()=>a],14670)},64659,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);e.s(["ChevronDown",()=>t],64659)},86536,e=>{"use strict";let t=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],86536)},88699,e=>{"use strict";let t=(0,e.i(75254).default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>t],88699)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},56909,e=>{"use strict";let t=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>t],56909)},20312,e=>{"use strict";function t(e){let t="\n---IMAGE---\n",s=e.indexOf(t);return -1===s?{text:e,image:null}:{text:e.slice(0,s),image:e.slice(s+t.length)}}function s(e){if(null==e||""===e)return"-";let t="number"==typeof e?e:Number(String(e).replace(/,/g,""));return!t||isNaN(t)?"-":`${t.toLocaleString("ko-KR")}원`}e.s(["formatPrice",()=>s,"parsePopupContent",()=>t])},54508,31278,e=>{"use strict";var t=e.i(43476),s=e.i(88699),a=e.i(27612),l=e.i(20312);function r({optionName:e,popupContent:r,prices:i,cellValues:n,columns:c,apartmentTypes:d,onEdit:o,onDelete:u}){let{image:x}=r?(0,l.parsePopupContent)(r):{image:null},m=[];for(let e of c)if("amount"===e.columnType||!e.columnType){let t=e.customName||d.find(t=>t.id===e.apartmentTypeId)?.name||"가격",s=i?.[e.id]||(n?.[e.id]?Number(String(n[e.id]).replace(/,/g,"")):0);m.push({label:t,value:(0,l.formatPrice)(s||0)})}return(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden hover:shadow-sm transition-shadow",children:(0,t.jsxs)("div",{className:"flex",children:[x&&(0,t.jsx)("div",{className:"w-20 h-20 flex-shrink-0 bg-gray-100",children:(0,t.jsx)("img",{src:x,alt:e,className:"w-full h-full object-cover"})}),(0,t.jsxs)("div",{className:"flex-1 p-3 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold text-gray-800 truncate",children:e}),(0,t.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(0,t.jsx)("button",{onClick:o,className:"p-1.5 rounded-lg hover:bg-gray-100 text-gray-400 hover:text-gray-600",children:(0,t.jsx)(s.Pencil,{className:"w-3.5 h-3.5"})}),(0,t.jsx)("button",{onClick:u,className:"p-1.5 rounded-lg hover:bg-red-50 text-gray-400 hover:text-red-500",children:(0,t.jsx)(a.Trash2,{className:"w-3.5 h-3.5"})})]})]}),m.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1.5 mt-1.5",children:m.map(e=>(0,t.jsxs)("span",{className:"text-xs bg-blue-50 text-blue-600 px-2 py-0.5 rounded-full",children:[e.label,": ",e.value]},e.label))})]})]})})}e.s(["default",()=>r],54508);let i=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>i],31278)},55523,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),l=e.i(9165),r=e.i(59544),i=e.i(39964),n=e.i(96640),c=e.i(32098),d=e.i(22706),o=e.i(14670),u=e.i(54508),x=e.i(37727),m=e.i(75254);let h=(0,m.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),p=(0,m.default)("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),g=(0,m.default)("image-plus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);var f=e.i(27612),y=e.i(88840);function b({content:e,onChange:a,disabled:l}){let[i,n]=(0,s.useState)(!1),[c,d]=(0,s.useState)(""),[o,u]=(0,s.useState)(null),m=(0,s.useRef)(null),{toast:h}=(0,y.useToast)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>{let t,s,{text:a,image:l}=(t="\n---IMAGE---\n",-1===(s=e.indexOf(t))?{text:e,image:null}:{text:e.slice(0,s),image:e.slice(s+t.length)});d(a),u(l),n(!0)},disabled:l,className:`p-1 rounded-lg transition-colors ${e?"text-blue-500 hover:bg-blue-50":"text-gray-300 hover:bg-gray-50 hover:text-gray-500"}`,title:"팝업 콘텐츠 편집",children:(0,t.jsx)(p,{className:"w-4 h-4"})}),i&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl p-6 w-full max-w-md space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:"팝업 콘텐츠"}),(0,t.jsx)("button",{onClick:()=>n(!1),className:"p-1 hover:bg-gray-100 rounded-lg",children:(0,t.jsx)(x.X,{className:"w-5 h-5 text-gray-400"})})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"고객이 [?] 아이콘을 클릭하면 표시되는 상세 설명입니다."}),(0,t.jsx)("textarea",{value:c,onChange:e=>d(e.target.value),placeholder:"옵션에 대한 상세 설명을 입력하세요...",rows:4,disabled:l,className:"w-full px-4 py-3 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none disabled:bg-gray-50"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-medium text-gray-600 mb-2",children:"이미지 (선택)"}),o?(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:o,alt:"팝업 이미지",className:"w-full max-h-48 object-contain rounded-lg border border-gray-200"}),(0,t.jsx)("button",{onClick:()=>u(null),disabled:l,className:"absolute top-2 right-2 p-1 bg-white rounded-full shadow hover:bg-error-light",children:(0,t.jsx)(f.Trash2,{className:"w-4 h-4 text-error"})})]}):(0,t.jsxs)("button",{onClick:()=>m.current?.click(),disabled:l,className:"w-full flex items-center justify-center gap-2 py-3 border-2 border-dashed border-gray-200 rounded-xl text-sm text-gray-400 hover:border-blue-300 hover:text-blue-500 transition-colors disabled:opacity-50",children:[(0,t.jsx)(g,{className:"w-5 h-5"}),"이미지 추가 (2MB 이하)"]}),(0,t.jsx)("input",{ref:m,type:"file",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];if(!t)return;if(t.size>2097152)return void h("이미지는 2MB 이하만 가능합니다.","error");let s=new FileReader;s.onload=()=>{u(s.result)},s.readAsDataURL(t),m.current&&(m.current.value="")},className:"hidden"})]}),(0,t.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,t.jsx)(r.default,{variant:"secondary",onClick:()=>n(!1),children:"취소"}),(0,t.jsx)(r.default,{onClick:()=>{a(o?`${c}
---IMAGE---
${o}`:c),n(!1)},disabled:l,children:"저장"})]})]})})]})}function j({isOpen:e,onClose:a,onSave:l,apartmentTypes:i,columns:n,initialData:c,title:d="품목 추가"}){let[o,u]=(0,s.useState)(""),[m,p]=(0,s.useState)(""),[g,f]=(0,s.useState)({}),[y,j]=(0,s.useState)({}),[v,N]=(0,s.useState)("");if((0,s.useEffect)(()=>{if(e)if(c){if(u(c.optionName),p(c.popupContent||""),f(c.prices||{}),j(c.cellValues||{}),n.length>0&&i.length>0){for(let e of n)if(e.apartmentTypeId&&(c.prices?.[e.id]||c.cellValues?.[e.id])){N(e.apartmentTypeId);break}}}else u(""),p(""),f({}),j({}),N(i.length>0?i[0].id:"")},[e,c,n,i]),!e)return null;let w=m.match(/---IMAGE---\n(https?:\/\/[^\n]+)/),k=w?w[1]:null,C=i.length>0&&n.length>0;return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end sm:items-center justify-center",onClick:a,children:(0,t.jsxs)("div",{className:"bg-white w-full max-w-lg rounded-t-2xl sm:rounded-2xl max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"sticky top-0 bg-white z-10 px-5 py-4 border-b border-gray-100 flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:d}),(0,t.jsx)("button",{onClick:a,className:"p-1.5 hover:bg-gray-100 rounded-lg",children:(0,t.jsx)(x.X,{className:"w-5 h-5 text-gray-400"})})]}),(0,t.jsxs)("div",{className:"p-5 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-1.5",children:"이미지"}),k?(0,t.jsxs)("div",{className:"relative rounded-xl overflow-hidden bg-gray-100 h-40",children:[(0,t.jsx)("img",{src:k,alt:"품목",className:"w-full h-full object-cover"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:(0,t.jsx)(b,{content:m,onChange:p})})]}):(0,t.jsxs)("div",{className:"border-2 border-dashed border-gray-200 rounded-xl h-32 flex flex-col items-center justify-center gap-2 text-gray-400",children:[(0,t.jsx)(h,{className:"w-8 h-8"}),(0,t.jsx)(b,{content:m,onChange:p})]})]}),C&&i.length>1&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-1.5",children:"타입"}),(0,t.jsxs)("select",{value:v,onChange:e=>N(e.target.value),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[(0,t.jsx)("option",{value:"",children:"타입을 선택하세요"}),i.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-1.5",children:["상세 품목 제목 ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"text",value:o,onChange:e=>u(e.target.value),placeholder:"품목 이름을 입력하세요",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-1.5",children:"상세 설명"}),(0,t.jsx)("textarea",{value:m.replace(/---IMAGE---\n[^\n]*/g,"").trim(),onChange:e=>{p((w?`---IMAGE---
${w[1]}
`:"")+e.target.value)},placeholder:"품목에 대한 상세 설명을 입력하세요",rows:3,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-1.5",children:"비용"}),(0,t.jsxs)("div",{className:"space-y-2",children:[n.map(e=>{let s=e.customName||i.find(t=>t.id===e.apartmentTypeId)?.name||"열",a="amount"===e.columnType||!e.columnType;return(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500 w-20 flex-shrink-0 truncate",children:s}),a?(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)("input",{type:"text",inputMode:"numeric",value:g[e.id]?function(e){let t="string"==typeof e?e.replace(/,/g,""):String(e);if(!t||"0"===t)return"";let s=parseInt(t,10);return isNaN(s)?"":s.toLocaleString("ko-KR")}(g[e.id]):"",onChange:t=>{var s;let a,l;return s=e.id,l=""===(a=t.target.value.replace(/[^0-9]/g,""))?0:parseInt(a,10)||0,void(f(e=>({...e,[s]:l})),j(e=>({...e,[s]:String(l)})))},placeholder:"0",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm text-right focus:outline-none focus:ring-2 focus:ring-blue-500 pr-8"}),(0,t.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400",children:"원"})]}):(0,t.jsx)("input",{type:"text",value:y[e.id]||"",onChange:t=>{var s,a;return s=e.id,a=t.target.value,void j(e=>({...e,[s]:a}))},placeholder:"입력",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]},e.id)}),0===n.length&&(0,t.jsx)("p",{className:"text-xs text-gray-400",children:"타입이 설정되면 가격 입력란이 표시됩니다."})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)(r.default,{variant:"outline",fullWidth:!0,onClick:a,children:"취소"}),(0,t.jsx)(r.default,{fullWidth:!0,onClick:()=>{o.trim()&&(l({optionName:o.trim(),popupContent:m,prices:g,cellValues:y}),a())},disabled:!o.trim(),children:"저장"})]})]})]})})}var v=e.i(86536),N=e.i(94918),w=e.i(7233),k=e.i(56909),C=e.i(31278),S=e.i(64659);let T=0;function M(){return`k_${++T}_${Date.now()}`}function _(){let{id:e}=(0,a.useParams)(),x=(0,a.useRouter)(),{toast:m}=(0,y.useToast)(),[h,p]=(0,s.useState)(null),[g,b]=(0,s.useState)(null),[T,_]=(0,s.useState)(!0),[I,z]=(0,s.useState)(!1),O=(0,s.useRef)(!1),[V,$]=(0,s.useState)([]),[A,E]=(0,s.useState)([]),[P,D]=(0,s.useState)(""),[R,H]=(0,s.useState)(!1),[L,B]=(0,s.useState)(!1),[F,G]=(0,s.useState)(null),[W,K]=(0,s.useState)(null),U=async()=>{try{let t=await l.default.get(`/ic/configs/event/${e}`).then(e=>(0,l.extractData)(e));p(t);let s=await l.default.get("/ic/sheets/my",{params:{configId:t.id}}).then(e=>(0,l.extractData)(e));if(s.length>0)b(s[0]),$(s[0].columns||[]),E((s[0].rows||[]).map(e=>({...e,_key:e.id||M()}))),D(s[0].categoryName||"");else if(!O.current){O.current=!0;try{let e=t.categories&&t.categories.length>0?t.categories[0]:"품목",s=await l.default.post("/ic/sheets",{configId:t.id,categoryName:e}).then(e=>(0,l.extractData)(e));b(s),$(s.columns||[]),E((s.rows||[]).map(e=>({...e,_key:e.id||M()}))),D(s.categoryName||e)}catch{m("시트 자동 생성에 실패했습니다.","error")}}}catch{p(null),b(null)}finally{_(!1)}};(0,s.useEffect)(()=>{U()},[e]);let X=async()=>{if(g){z(!0);try{P&&P!==g.categoryName&&await l.default.patch(`/ic/sheets/${g.id}`,{categoryName:P});let e=V.map((e,t)=>({id:e.id,apartmentTypeId:e.apartmentTypeId,customName:e.customName,columnType:e.columnType||"amount",sortOrder:t})),t=await l.default.put(`/ic/sheets/${g.id}/columns`,{columns:e}),s=t.data?.data||[],a=new Map;s.length===V.length&&[...s].sort((e,t)=>(e.sortOrder??0)-(t.sortOrder??0)).forEach((e,t)=>{let s=V[t]?.id;s&&e.id&&s!==e.id&&a.set(s,e.id)});let r=new Set(s.map(e=>e.id).filter(Boolean)),i=A.map(({_key:e,...t},s)=>{let l={},i={};for(let[e,s]of Object.entries(t.prices||{})){let t=a.get(e)||e;r.has(t)&&(l[t]=s)}for(let[e,s]of Object.entries(t.cellValues||{})){let t=a.get(e)||e;r.has(t)&&(i[t]=s)}return{...t,sortOrder:s,prices:l,cellValues:i}}),n=await l.default.put(`/ic/sheets/${g.id}/rows`,{rows:i}),c=n.data?.data||[];if(s.length>0){let e=[...s].sort((e,t)=>(e.sortOrder??0)-(t.sortOrder??0));$(e)}if(c.length>0){let e=[...c].sort((e,t)=>(e.sortOrder??0)-(t.sortOrder??0));E(e.map(e=>({...e,_key:e.id||M()})))}m("저장되었습니다.","success")}catch(t){let e=t?.response?.data?.message;m(Array.isArray(e)?e.join(", "):e||"저장에 실패했습니다.","error")}finally{z(!1)}}},q=async e=>{if(g)try{await l.default.patch(`/ic/sheets/${g.id}`,{status:e}),m("active"===e?"시트가 활성화되었습니다.":"시트 상태가 변경되었습니다.","success"),await U()}catch{m("상태 변경에 실패했습니다.","error")}};if(T)return(0,t.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,t.jsx)("div",{className:"h-24 bg-white rounded-xl animate-pulse"},e))});if(!h)return(0,t.jsxs)("div",{children:[(0,t.jsx)(d.default,{title:"상세 품목 관리",backHref:`/partner/events/${e}`}),(0,t.jsx)(i.default,{children:(0,t.jsx)(o.default,{title:"통합 계약 설정이 없습니다",description:"주관사가 통합 계약 설정을 먼저 생성해야 합니다."})})]});let J=h.categories||[],Q=null!==F?A[F]:null;return(0,t.jsxs)("div",{children:[I&&(0,t.jsx)("div",{className:"fixed inset-0 z-[200] bg-black/40 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl px-8 py-6 shadow-2xl flex items-center gap-4",children:[(0,t.jsx)(C.Loader2,{className:"w-6 h-6 text-blue-600 animate-spin"}),(0,t.jsx)("span",{className:"text-base font-medium text-gray-800",children:"저장 중..."})]})}),(0,t.jsx)(d.default,{title:"상세 품목 관리",subtitle:g?g.categoryName:"품목 시트를 편집하세요",backHref:`/partner/events/${e}`,actions:(0,t.jsxs)(r.default,{variant:"secondary",size:"sm",onClick:()=>x.push(`/partner/events/${e}/sheet/preview`),children:[(0,t.jsx)(v.Eye,{className:"w-4 h-4 mr-1"}),"미리보기"]})}),g?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(i.default,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("h3",{className:"font-bold text-gray-800",children:"품목"}),(0,t.jsx)(n.default,{status:g.status})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["draft"===g.status&&(0,t.jsx)(r.default,{variant:"secondary",size:"sm",onClick:()=>q("active"),children:"활성화"}),"active"===g.status&&(0,t.jsx)(r.default,{variant:"secondary",size:"sm",onClick:()=>q("inactive"),children:"비활성화"})]})]}),J.length>0&&(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"품목 카테고리"}),(0,t.jsxs)("button",{onClick:()=>H(!R),className:"w-full flex items-center justify-between px-3 py-2.5 border border-gray-200 rounded-lg text-sm bg-white hover:border-gray-300 transition-colors",children:[(0,t.jsx)("span",{className:P?"text-gray-800 font-medium":"text-gray-400",children:P||"품목을 선택하세요"}),(0,t.jsx)(S.ChevronDown,{className:`w-4 h-4 text-gray-400 transition-transform ${R?"rotate-180":""}`})]}),R&&(0,t.jsx)("div",{className:"absolute top-full left-0 right-0 z-10 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto",children:J.map(e=>(0,t.jsx)("button",{onClick:()=>{D(e),H(!1)},className:`w-full text-left px-3 py-2.5 text-sm hover:bg-gray-50 transition-colors ${P===e?"bg-blue-50 text-blue-700 font-medium":"text-gray-700"}`,children:e},e))})]})]}),0===A.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(N.FileSpreadsheet,{className:"w-8 h-8 text-gray-300"})}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"상세 품목을 등록해주세요"}),(0,t.jsx)("p",{className:"text-xs text-gray-400",children:"아래 버튼을 눌러 품목을 추가하세요"}),(0,t.jsx)("button",{onClick:()=>{G(null),B(!0)},className:"mt-4 w-14 h-14 rounded-full bg-blue-600 text-white flex items-center justify-center mx-auto shadow-lg hover:bg-blue-700 transition-colors",children:(0,t.jsx)(w.Plus,{className:"w-7 h-7"})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"overflow-x-auto -mx-4 px-4 pb-2",children:(0,t.jsxs)("div",{className:"flex gap-3",style:{minWidth:"min-content"},children:[A.map((e,s)=>(0,t.jsx)("div",{className:"w-44 flex-shrink-0",children:(0,t.jsx)(u.default,{optionName:e.optionName,popupContent:e.popupContent,prices:e.prices||{},cellValues:e.cellValues,columns:V.map(e=>({id:e.id,customName:e.customName,columnType:e.columnType,apartmentTypeId:e.apartmentTypeId})),apartmentTypes:h.apartmentTypes||[],onEdit:()=>{G(s),B(!0)},onDelete:()=>K(s)})},e._key)),(0,t.jsx)("div",{className:"w-44 flex-shrink-0",children:(0,t.jsxs)("button",{onClick:()=>{G(null),B(!0)},className:"w-full h-full min-h-[160px] border-2 border-dashed border-gray-200 rounded-xl flex flex-col items-center justify-center gap-2 text-gray-400 hover:border-blue-400 hover:text-blue-500 hover:bg-blue-50/30 transition-colors",children:[(0,t.jsx)(w.Plus,{className:"w-6 h-6"}),(0,t.jsx)("span",{className:"text-xs font-medium",children:"품목 추가"})]})})]})}),(0,t.jsxs)(r.default,{fullWidth:!0,size:"lg",onClick:X,loading:I,children:[(0,t.jsx)(k.Save,{className:"w-5 h-5 mr-2"}),"저장"]})]}),0===A.length&&(0,t.jsxs)(r.default,{fullWidth:!0,size:"lg",onClick:X,loading:I,disabled:0===A.length,children:[(0,t.jsx)(k.Save,{className:"w-5 h-5 mr-2"}),"저장"]})]}):(0,t.jsx)(i.default,{children:(0,t.jsx)(o.default,{title:"시트를 불러오는 중...",description:"잠시만 기다려 주세요",icon:(0,t.jsx)(N.FileSpreadsheet,{className:"w-12 h-12 text-gray-300"})})}),(0,t.jsx)(j,{isOpen:L,onClose:()=>{B(!1),G(null)},onSave:e=>{null!==F?E(t=>t.map((t,s)=>s===F?{...t,optionName:e.optionName,popupContent:e.popupContent||void 0,prices:e.prices,cellValues:e.cellValues,updatedAt:new Date().toISOString()}:t)):E(t=>[...t,{id:"",sheetId:g?.id||"",optionName:e.optionName,popupContent:e.popupContent||void 0,sortOrder:t.length,prices:e.prices,cellValues:e.cellValues,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),_key:M()}])},apartmentTypes:h.apartmentTypes||[],columns:V.map(e=>({id:e.id,customName:e.customName,columnType:e.columnType,apartmentTypeId:e.apartmentTypeId})),initialData:Q?{optionName:Q.optionName,popupContent:Q.popupContent,prices:Q.prices||{},cellValues:Q.cellValues}:void 0,title:null!==F?"품목 수정":"품목 추가"}),(0,t.jsxs)(c.default,{isOpen:null!==W,onClose:()=>K(null),title:"품목 삭제",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:[(0,t.jsxs)("strong",{children:["“",null!==W?A[W]?.optionName:"","”"]})," 품목을 삭제하시겠습니까?"]}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,t.jsx)(r.default,{variant:"outline",onClick:()=>K(null),children:"취소"}),(0,t.jsxs)(r.default,{variant:"danger",onClick:()=>{null!==W&&(E(e=>e.filter((e,t)=>t!==W)),K(null))},children:[(0,t.jsx)(f.Trash2,{className:"w-4 h-4 mr-1"}),"삭제"]})]})]})]})}e.s(["default",()=>_],55523)}]);