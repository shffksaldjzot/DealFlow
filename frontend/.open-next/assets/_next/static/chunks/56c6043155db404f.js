(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59544,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75157);let l=(0,s.forwardRef)(({className:e,variant:s="primary",size:l="md",fullWidth:r,loading:c,disabled:i,children:n,...d},x)=>(0,t.jsxs)("button",{ref:x,className:(0,a.cn)("inline-flex items-center justify-center font-semibold transition-all duration-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed active:scale-[0.98]",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 shadow-md hover:shadow-lg",secondary:"bg-gray-100 text-gray-800 hover:bg-gray-200 focus:ring-gray-400",outline:"border-2 border-blue-600 text-blue-600 hover:bg-blue-50 focus:ring-blue-500",ghost:"text-gray-600 hover:bg-gray-100 focus:ring-gray-400",danger:"bg-red-500 text-white hover:bg-red-600 focus:ring-red-400 shadow-md"}[s],{sm:"px-3 py-1.5 text-sm rounded-lg",md:"px-4 py-2.5 text-sm",lg:"px-6 py-3 text-base",xl:"px-8 py-4 text-lg"}[l],r&&"w-full",e),disabled:i||c,...d,children:[c&&(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n]}));l.displayName="Button",e.s(["default",0,l])},39964,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75157);let l=(0,s.forwardRef)(({className:e,hoverable:s,padding:l="md",children:r,...c},i)=>(0,t.jsx)("div",{ref:i,className:(0,a.cn)("bg-white rounded-2xl border border-gray-100","shadow-sm",{none:"",sm:"p-4",md:"p-5",lg:"p-6"}[l],s&&"hover:shadow-md hover:border-gray-200 transition-all duration-200 cursor-pointer",e),...c,children:r}));l.displayName="Card",e.s(["default",0,l])},96640,e=>{"use strict";var t=e.i(43476),s=e.i(75157);function a({status:e,className:a}){return(0,t.jsx)("span",{className:(0,s.cn)("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",(0,s.getStatusColor)(e),a),children:(0,s.getStatusLabel)(e)})}e.s(["default",()=>a])},63059,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>t],63059)},3116,e=>{"use strict";let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>t],3116)},8402,e=>{"use strict";let t=(0,e.i(75254).default)("ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);e.s(["Ticket",()=>t],8402)},69638,e=>{"use strict";let t=(0,e.i(75254).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],69638)},623,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566),l=e.i(92028),r=e.i(9165),c=e.i(39964),i=e.i(96640),n=e.i(59544),d=e.i(78583),x=e.i(63059),m=e.i(3116),o=e.i(69638),h=e.i(63209),u=e.i(8402),f=e.i(75254);let g=(0,f.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),j=(0,f.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),p=(0,f.default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var b=e.i(37727),y=e.i(73884),v=e.i(75157),N=e.i(88840);function w(){let{user:f}=(0,l.useAuthStore)(),w=(0,a.useRouter)(),{toast:k}=(0,N.useToast)(),[C,R]=(0,s.useState)([]),[T,A]=(0,s.useState)([]),[S,M]=(0,s.useState)(!0),[z,D]=(0,s.useState)(""),[Q,$]=(0,s.useState)(!1),[q,F]=(0,s.useState)(!1),P=(0,s.useRef)(null);(0,s.useEffect)(()=>{Promise.all([r.default.get("/customer/contracts").then(e=>R((0,r.extractData)(e))).catch(()=>{}),r.default.get("/event-visits/my").then(e=>A((0,r.extractData)(e))).catch(()=>{})]).finally(()=>M(!1))},[]);let B=async(e,t)=>{if(t.stopPropagation(),confirm("이 계약을 취소하시겠습니까?"))try{await r.default.post(`/customer/contracts/${e}/cancel`),k("계약이 취소되었습니다.","success"),r.default.get("/customer/contracts").then(e=>R((0,r.extractData)(e))).catch(()=>{})}catch{k("취소에 실패했습니다.","error")}},E=C.filter(e=>"pending"===e.status||"in_progress"===e.status),H=C.filter(e=>"signed"===e.status||"completed"===e.status),K=T.filter(e=>"reserved"===e.status),L=()=>{let e=z.trim().replace(/\s/g,"");e&&w.push(`/contract/${e}`)},U=(0,s.useCallback)(async()=>{if(P.current){try{await P.current.stop(),P.current.clear()}catch{}P.current=null}F(!1)},[]),V=async()=>{F(!0);let{Html5Qrcode:t}=await e.A(87087);setTimeout(async()=>{if(!document.getElementById("qr-reader"))return;let e=new t("qr-reader");P.current=e;try{await e.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},t=>{let s=t,a=t.match(/\/contract\/([^/?\s]+)/);a&&(s=a[1]);let l=t.match(/\/events\/([^/?\s]+)\/(visit|join)/);if(l){e.stop().catch(()=>{}),P.current=null,F(!1),w.push(`/events/${l[1]}/${l[2]}`);return}e.stop().catch(()=>{}),P.current=null,F(!1),w.push(`/contract/${s}`)},()=>{})}catch{F(!1),alert("카메라를 사용할 수 없습니다.\n카메라 권한을 확인하거나 아래 코드 입력란을 이용해주세요."),$(!0)}},100)};return(0,s.useEffect)(()=>()=>{P.current&&P.current.stop().catch(()=>{})},[]),(0,t.jsxs)("div",{children:[q&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 bg-black",children:(0,t.jsxs)("div",{className:"relative h-full flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,t.jsx)("h3",{className:"text-white font-bold text-lg",children:"QR 코드 스캔"}),(0,t.jsx)("button",{onClick:U,className:"w-10 h-10 rounded-full bg-white/20 flex items-center justify-center",children:(0,t.jsx)(b.X,{className:"w-6 h-6 text-white"})})]}),(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center px-4",children:(0,t.jsxs)("div",{className:"w-full max-w-sm",children:[(0,t.jsx)("div",{id:"qr-reader",className:"rounded-2xl overflow-hidden"}),(0,t.jsx)("p",{className:"text-white/70 text-sm text-center mt-4",children:"계약서 QR 코드 또는 방문예약 QR 코드를 스캔하세요"})]})}),(0,t.jsx)("div",{className:"p-4 pb-8",children:(0,t.jsx)("button",{onClick:()=>{U(),$(!0)},className:"w-full py-3 text-white/80 text-sm font-medium text-center",children:"코드 직접 입력하기"})})]})}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("h2",{className:"text-2xl font-bold text-gray-900",children:["안녕하세요, ",f?.name||"고객","님"]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"계약 현황을 확인하세요"})]}),(0,t.jsxs)("button",{onClick:V,className:"w-full mb-4 flex items-center justify-center gap-3 p-4 bg-blue-600 hover:bg-blue-700 text-white rounded-2xl transition-colors shadow-sm",children:[(0,t.jsx)(p,{className:"w-6 h-6"}),(0,t.jsx)("span",{className:"text-lg font-bold",children:"QR 코드 스캔"})]}),(0,t.jsx)("div",{className:"mb-6",children:Q?(0,t.jsx)(c.default,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g,{className:"w-5 h-5 text-gray-400 shrink-0"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-gray-900 mb-2",children:"계약 코드 입력"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:z,onChange:e=>D(e.target.value.toUpperCase().replace(/\s/g,"")),onKeyDown:e=>"Enter"===e.key&&L(),placeholder:"8자리 코드 입력",maxLength:16,autoComplete:"off",autoCorrect:"off",autoCapitalize:"characters",spellCheck:!1,className:"flex-1 px-4 py-2 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono tracking-widest",autoFocus:!0}),(0,t.jsx)(n.default,{onClick:L,disabled:!z.trim(),children:"확인"})]})]})]})}):(0,t.jsxs)("button",{onClick:()=>$(!0),className:"flex items-center gap-1.5 text-sm text-gray-500 hover:text-blue-600 transition-colors",children:[(0,t.jsx)(g,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"계약 코드 직접 입력"}),(0,t.jsx)(j,{className:"w-3.5 h-3.5"})]})}),!S&&E.length>0&&(0,t.jsx)(c.default,{className:"mb-6 border-2 border-orange-200 bg-orange-50",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-orange-100 flex items-center justify-center shrink-0",children:(0,t.jsx)(h.AlertCircle,{className:"w-5 h-5 text-orange-600"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("p",{className:"font-semibold text-orange-800",children:["서명 대기 중인 계약 ",E.length,"건"]}),(0,t.jsx)("p",{className:"text-sm text-orange-600 mt-0.5",children:"아래 계약서를 확인하고 서명해주세요"})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[(0,t.jsx)(c.default,{children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(d.FileText,{className:"w-5 h-5 text-gray-400 mx-auto mb-1"}),(0,t.jsx)("p",{className:"text-xl font-bold text-gray-900",children:S?"-":C.length}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"전체"})]})}),(0,t.jsx)(c.default,{children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(m.Clock,{className:"w-5 h-5 text-orange-400 mx-auto mb-1"}),(0,t.jsx)("p",{className:"text-xl font-bold text-orange-600",children:S?"-":E.length}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"대기중"})]})}),(0,t.jsx)(c.default,{children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(o.CheckCircle,{className:"w-5 h-5 text-green-400 mx-auto mb-1"}),(0,t.jsx)("p",{className:"text-xl font-bold text-green-600",children:S?"-":H.length}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"완료"})]})})]}),!S&&E.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"서명 대기 계약"}),(0,t.jsx)("div",{className:"space-y-2 mb-6",children:E.map(e=>(0,t.jsx)(c.default,{hoverable:!0,onClick:()=>w.push(`/customer/contracts/${e.id}`),className:"border-l-4 border-l-orange-400",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 text-sm",children:e.event?.name||"계약서"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(i.default,{status:e.status}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:(0,v.formatDateTime)(e.createdAt)})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:t=>B(e.id,t),className:"p-1.5 rounded-lg hover:bg-red-50 text-gray-400 hover:text-red-500 transition-colors",title:"취소",children:(0,t.jsx)(y.XCircle,{className:"w-4 h-4"})}),(0,t.jsx)(n.default,{size:"sm",onClick:t=>{t.stopPropagation(),w.push(`/customer/contracts/${e.id}`)},children:"서명하기"})]})]})},e.id))})]}),!S&&K.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"방문 예약"}),(0,t.jsx)("div",{className:"space-y-2 mb-6",children:K.map(e=>(0,t.jsx)(c.default,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900 text-sm",children:e.event?.name||"행사"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-500",children:[(0,t.jsx)(u.Ticket,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:(0,v.formatDate)(e.visitDate)}),(0,t.jsxs)("span",{children:[e.guestCount,"명"]})]})]}),(0,t.jsx)(i.default,{status:"approved"})]})},e.id))})]}),(0,t.jsx)(c.default,{hoverable:!0,onClick:()=>w.push("/customer/contracts"),className:"mb-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center",children:(0,t.jsx)(d.FileText,{className:"w-5 h-5 text-blue-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-gray-900",children:"내 계약"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"전체 계약 내역 보기"})]})]}),(0,t.jsx)(x.ChevronRight,{className:"w-5 h-5 text-gray-400"})]})}),T.length>0&&(0,t.jsx)(c.default,{hoverable:!0,onClick:()=>w.push("/customer/reservations"),className:"mb-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center",children:(0,t.jsx)(u.Ticket,{className:"w-5 h-5 text-green-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-gray-900",children:"방문 예약"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"예약 내역 확인"})]})]}),(0,t.jsx)(x.ChevronRight,{className:"w-5 h-5 text-gray-400"})]})}),!S&&H.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3 mt-6",children:"완료된 계약"}),(0,t.jsx)("div",{className:"space-y-2",children:H.slice(0,3).map(e=>(0,t.jsx)(c.default,{hoverable:!0,onClick:()=>w.push(`/customer/contracts/${e.id}`),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-400 font-mono",children:e.contractNumber}),(0,t.jsx)("p",{className:"font-medium text-gray-900 text-sm mt-0.5",children:e.event?.name||"계약서"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(i.default,{status:e.status}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:(0,v.formatDateTime)(e.createdAt)})]})]}),(0,t.jsx)(x.ChevronRight,{className:"w-5 h-5 text-gray-400"})]})},e.id))})]}),(0,t.jsxs)("div",{className:"bg-blue-50 rounded-2xl p-5 mt-6",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-blue-800 mb-1",children:"QR 코드로 계약하기"}),(0,t.jsx)("p",{className:"text-sm text-blue-600",children:"QR 코드 스캔 버튼을 누르면 카메라가 실행됩니다. 계약서 QR 코드 또는 방문예약 QR 코드를 스캔하세요."})]})]})}e.s(["default",()=>w],623)},87087,e=>{e.v(t=>Promise.all(["static/chunks/1c9ffce5dd967e02.js"].map(t=>e.l(t))).then(()=>t(5003)))}]);