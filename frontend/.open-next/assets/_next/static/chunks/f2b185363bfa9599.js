(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59544,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(75157);let a=(0,s.forwardRef)(({className:e,variant:s="primary",size:a="md",fullWidth:l,loading:n,disabled:i,children:c,...o},d)=>(0,t.jsxs)("button",{ref:d,className:(0,r.cn)("inline-flex items-center justify-center font-semibold transition-all duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-45 disabled:cursor-not-allowed active:scale-[0.98]",{primary:"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-sm focus:ring-blue-500",secondary:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 hover:shadow-sm focus:ring-gray-400",outline:"border-2 border-blue-600 text-blue-600 hover:bg-blue-50 focus:ring-blue-500",ghost:"text-blue-600 hover:bg-blue-50 focus:ring-blue-500",danger:"bg-error text-white hover:opacity-90 hover:shadow-sm focus:ring-red-400",success:"bg-success text-white hover:opacity-90 hover:shadow-sm focus:ring-success"}[s],{sm:"px-3.5 py-1.5 text-[13px]",md:"px-5 py-2.5 text-sm",lg:"px-7 py-3 text-base",xl:"px-9 py-4 text-lg rounded-xl"}[a],l&&"w-full",e),disabled:i||n,...o,children:[n&&(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c]}));a.displayName="Button",e.s(["default",0,a])},39964,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(75157);let a=(0,s.forwardRef)(({className:e,hoverable:s,padding:a="md",children:l,...n},i)=>(0,t.jsx)("div",{ref:i,className:(0,r.cn)("bg-white rounded-xl border border-gray-200","shadow-[0_1px_3px_rgba(0,0,0,0.1),0_1px_2px_rgba(0,0,0,0.06)]",{none:"",sm:"p-4",md:"p-5",lg:"p-6"}[a],s&&"hover:shadow-[0_4px_6px_-1px_rgba(0,0,0,0.1),0_2px_4px_-1px_rgba(0,0,0,0.06)] transition-all duration-200 cursor-pointer",e),...n,children:l}));a.displayName="Card",e.s(["default",0,a])},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},63059,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);e.s(["ChevronRight",()=>t],63059)},94351,e=>{"use strict";let t=(0,e.i(75254).default)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]]);e.s(["Home",()=>t],94351)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},20312,e=>{"use strict";function t(e){let t="\n---IMAGE---\n",s=e.indexOf(t);return -1===s?{text:e,image:null}:{text:e.slice(0,s),image:e.slice(s+t.length)}}function s(e){if(null==e||""===e)return"-";let t="number"==typeof e?e:Number(String(e).replace(/,/g,""));return!t||isNaN(t)?"-":`${t.toLocaleString("ko-KR")}원`}e.s(["formatPrice",()=>s,"parsePopupContent",()=>t])},31782,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(43531);let a=(0,e.i(75254).default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var l=e.i(7233),n=e.i(20312);function i({optionName:e,price:s,popupContent:i,selected:c,onSelect:o,onDetail:d}){let{image:m}=i?(0,n.parsePopupContent)(i):{image:null};return(0,t.jsxs)("div",{className:`flex-shrink-0 w-[140px] rounded-xl border-2 overflow-hidden transition-all ${c?"border-blue-500 bg-blue-50 shadow-md shadow-blue-100":"border-gray-200 bg-white hover:border-gray-300 hover:shadow-sm"}`,children:[(0,t.jsxs)("div",{className:"relative h-24 bg-gray-100 flex items-center justify-center overflow-hidden cursor-pointer",onClick:d||o,children:[m?(0,t.jsx)("img",{src:m,alt:e,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"text-gray-300 text-xs",children:"No Image"}),c&&(0,t.jsx)("div",{className:"absolute top-1.5 right-1.5 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:(0,t.jsx)(r.Check,{className:"w-3 h-3 text-white"})}),i&&d&&(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),d()},className:"absolute top-1.5 left-1.5 w-6 h-6 bg-white/80 backdrop-blur rounded-full flex items-center justify-center hover:bg-white",children:(0,t.jsx)(a,{className:"w-3.5 h-3.5 text-gray-500"})})]}),(0,t.jsxs)("div",{className:"p-2.5",children:[(0,t.jsx)("p",{className:`text-xs font-medium line-clamp-2 leading-tight ${c?"text-blue-700":"text-gray-800"}`,children:e}),void 0!==s&&(0,t.jsx)("p",{className:`text-xs mt-1 font-semibold ${c?"text-blue-600":"text-gray-600"}`,children:(0,n.formatPrice)(s)}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),o?.()},className:`w-full mt-2 py-1.5 rounded-lg text-xs font-semibold transition-colors ${c?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-blue-50 hover:text-blue-600"}`,children:c?(0,t.jsxs)("span",{className:"flex items-center justify-center gap-1",children:[(0,t.jsx)(r.Check,{className:"w-3 h-3"})," 선택됨"]}):(0,t.jsxs)("span",{className:"flex items-center justify-center gap-1",children:[(0,t.jsx)(l.Plus,{className:"w-3 h-3"})," 추가하기"]})})]})]})}var c=e.i(37727),o=e.i(59544);function d({isOpen:e,onClose:s,optionName:a,popupContent:i,price:d,selected:m,onSelect:x}){if(!e)return null;let{text:u,image:h}=(0,n.parsePopupContent)(i);return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end justify-center",onClick:s,children:(0,t.jsxs)("div",{className:"bg-white w-full max-w-lg rounded-t-2xl max-h-[85vh] overflow-y-auto animate-slide-up",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"flex justify-center pt-3 pb-1",children:(0,t.jsx)("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),h&&(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:h,alt:a,className:"w-full max-h-64 object-cover"}),(0,t.jsx)("button",{onClick:s,className:"absolute top-3 right-3 w-8 h-8 bg-black/40 backdrop-blur rounded-full flex items-center justify-center",children:(0,t.jsx)(c.X,{className:"w-5 h-5 text-white"})})]}),(0,t.jsxs)("div",{className:"p-5 space-y-4",children:[!h&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:a}),(0,t.jsx)("button",{onClick:s,className:"p-1.5 hover:bg-gray-100 rounded-lg",children:(0,t.jsx)(c.X,{className:"w-5 h-5 text-gray-400"})})]}),h&&(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:a}),void 0!==d&&(0,t.jsx)("p",{className:"text-xl font-bold text-blue-600",children:(0,n.formatPrice)(d)}),u&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1.5",children:"시공범위"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-wrap leading-relaxed",children:u})]}),x&&(0,t.jsx)(o.default,{fullWidth:!0,size:"lg",variant:m?"outline":"primary",onClick:()=>{x(),s()},children:m?(0,t.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(r.Check,{className:"w-5 h-5"})," 선택 해제"]}):(0,t.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(l.Plus,{className:"w-5 h-5"})," 추가하기"]})})]})]})})}function m({partners:e,selectedRows:r,onToggleRow:l,selectedTypeId:n}){let[c,o]=(0,s.useState)(null),m=(e,t)=>r.some(s=>s.sheetId===e&&s.rowId===t),x=[];return e.forEach(e=>{e.categories.forEach(t=>{x.push({id:t.sheetId,name:t.categoryName,partnerName:e.partnerName,partnerId:e.partnerId,options:t.options,columns:t.columns})})}),(0,t.jsxs)("div",{className:"space-y-6",children:[x.map(e=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,t.jsx)("h4",{className:"text-base font-bold text-gray-800",children:e.name}),(0,t.jsx)("button",{className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)(a,{className:"w-4 h-4"})})]}),e.options.length>0?(0,t.jsx)("div",{className:"flex gap-3 overflow-x-auto pb-2 -mx-1 px-1 scrollbar-hide",children:e.options.map(s=>{let r=((e,t)=>{if(!n)return;let s=t.find(e=>e.apartmentTypeId===n);if(s){let t=e.cellValues?.[s.id];if(void 0!==t&&""!==t&&"0"!==t){let e=Number(String(t).replace(/,/g,""));if(e>0)return e}let r=e.prices?.[s.id];if(r&&r>0)return r}for(let s of t)if("amount"===s.columnType||!s.columnType){let t=e.prices?.[s.id];if(t&&t>0)return t;let r=e.cellValues?.[s.id];if(r){let e=Number(String(r).replace(/,/g,""));if(e>0)return e}}})(s,e.columns),a=m(e.id,s.rowId);return(0,t.jsx)(i,{optionName:s.optionName,price:r,popupContent:s.popupContent,selected:a,onSelect:()=>l(e.id,s.rowId,s.optionName,e.name,e.partnerName),onDetail:s.popupContent?()=>o({optionName:s.optionName,popupContent:s.popupContent,price:r,sheetId:e.id,rowId:s.rowId,categoryName:e.name,partnerName:e.partnerName}):void 0},s.rowId)})}):(0,t.jsx)("div",{className:"text-center py-8 text-gray-400 text-sm",children:"등록된 옵션이 없습니다."})]},e.id)),0===x.length&&(0,t.jsx)("div",{className:"text-center py-12 text-gray-400 text-sm",children:"등록된 품목이 없습니다."}),c&&(0,t.jsx)(d,{isOpen:!0,onClose:()=>o(null),optionName:c.optionName,popupContent:c.popupContent,price:c.price,selected:m(c.sheetId,c.rowId),onSelect:()=>{l(c.sheetId,c.rowId,c.optionName,c.categoryName,c.partnerName)}})]})}e.s(["default",()=>m],31782)},70255,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18566),a=e.i(92028),l=e.i(9165),n=e.i(39964),i=e.i(59544),c=e.i(31782);function o({items:e,paymentStages:s}){let r,a,l=e.reduce((e,t)=>e+t.unitPrice,0),n=s.length>0?(r=s.map(e=>({name:e.name,ratio:e.ratio,amount:Math.round(l*e.ratio/100)})),0!=(a=l-r.reduce((e,t)=>e+t.amount,0))&&r.length>0&&(r[r.length-1].amount+=a),r):[{name:"일시불",ratio:100,amount:l}],i=e.reduce((e,t)=>{let s=`${t.partnerName} - ${t.categoryName}`;return e[s]||(e[s]=[]),e[s].push(t),e},{});return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-sm font-bold text-gray-500 mb-2",children:"선택 내역"}),0===e.length?(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"선택된 품목이 없습니다."}):(0,t.jsx)("div",{className:"space-y-3",children:Object.entries(i).map(([e,s])=>(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:e}),s.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,t.jsx)("span",{className:"text-sm text-gray-700",children:e.optionName}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-800",children:e.unitPrice?`${e.unitPrice.toLocaleString()}원`:"무료"})]},s))]},e))})]}),(0,t.jsx)("div",{className:"border-t border-gray-200 pt-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"font-bold text-gray-800",children:"총액"}),(0,t.jsxs)("span",{className:"text-xl font-bold text-blue-600",children:[l.toLocaleString(),"원"]})]})}),e.length>0&&(0,t.jsxs)("div",{className:"bg-gray-50 rounded-xl p-3 space-y-2",children:[(0,t.jsx)("h4",{className:"text-sm font-bold text-gray-500",children:"결제 스케줄"}),n.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:[e.name||`${s+1}차`," (",e.ratio,"%)"]}),(0,t.jsxs)("span",{className:"text-sm font-medium text-gray-800",children:[e.amount.toLocaleString(),"원"]})]},s))]})]})}var d=e.i(88840),m=e.i(75254);let x=(0,m.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),u=(0,m.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var h=e.i(94351),p=e.i(63059);function g(){let{code:e}=(0,r.useParams)(),m=(0,r.useRouter)(),{toast:g}=(0,d.useToast)(),{user:f,isAuthenticated:b}=(0,a.useAuthStore)(),[y,j]=(0,s.useState)(null),[N,v]=(0,s.useState)(!0),[w,k]=(0,s.useState)([]),[C,I]=(0,s.useState)("type"),[T,S]=(0,s.useState)(!1),[$,P]=(0,s.useState)(!1),[M,R]=(0,s.useState)(""),[_,z]=(0,s.useState)(""),[A,L]=(0,s.useState)(""),[E,B]=(0,s.useState)(""),[D,H]=(0,s.useState)(""),O=(0,s.useRef)(null),[V,W]=(0,s.useState)(!1),[U,X]=(0,s.useState)(!1);(0,s.useEffect)(()=>{b||m.replace(`/login?redirect=/events/${e}/options`)},[b,e,m]),(0,s.useEffect)(()=>{b&&l.default.get(`/ic/contract-flow-by-code/${e}`).then(e=>{let t=(0,l.extractData)(e);j(t),1===t.apartmentTypes.length?(H(t.apartmentTypes[0].id),I("select")):0===t.apartmentTypes.length&&I("select")}).catch(()=>{}).finally(()=>v(!1))},[e,b]),(0,s.useEffect)(()=>{f&&(R(f.name||""),z(f.phone||""))},[f]);let F=e=>null==e||""===e?0:"number"==typeof e?e:Number(String(e).replace(/,/g,""))||0,K=e=>y?w.map(t=>{for(let s of y.partners)for(let r of s.categories){if(r.sheetId!==t.sheetId)continue;let s=r.options.find(e=>e.rowId===t.rowId);if(!s)continue;let a=r.columns.find(t=>t.apartmentTypeId===e),l=a?.id||"",n=0;if(a&&("amount"===a.columnType||!a.columnType)){let e=s.cellValues?.[l];n=void 0!==e?F(e):F(s.prices?.[l])}if(0===n)for(let e of r.columns.filter(e=>"amount"===e.columnType||!e.columnType)){let t=F(s.prices?.[e.id]);if(t>0){n=t,l=e.id;break}let r=F(s.cellValues?.[e.id]);if(r>0){n=r,l=e.id;break}}return{sheetId:t.sheetId,rowId:t.rowId,columnId:l,optionName:t.optionName,categoryName:t.categoryName,partnerName:t.partnerName,unitPrice:n}}return{sheetId:t.sheetId,rowId:t.rowId,columnId:"",optionName:t.optionName,categoryName:t.categoryName,partnerName:t.partnerName,unitPrice:0}}):[],Y=e=>{let t=O.current;if(!t)return{x:0,y:0};let s=t.getBoundingClientRect();return"touches"in e?{x:e.touches[0].clientX-s.left,y:e.touches[0].clientY-s.top}:{x:e.clientX-s.left,y:e.clientY-s.top}},q=e=>{let t=O.current?.getContext("2d");if(!t)return;W(!0);let s=Y(e);t.beginPath(),t.moveTo(s.x,s.y)},G=e=>{if(!V)return;let t=O.current?.getContext("2d");if(!t)return;let s=Y(e);t.lineTo(s.x,s.y),t.strokeStyle="#1e293b",t.lineWidth=2,t.lineCap="round",t.stroke(),X(!0)},J=()=>W(!1),Q=async()=>{if(!b)return void m.push(`/login?redirect=/events/${e}/options`);if(!y||0===w.length)return void g("품목을 선택해주세요.","error");if(!D)return void g("아파트 타입을 선택해주세요.","error");if(!M.trim())return void g("이름을 입력해주세요.","error");if(!_.trim())return void g("연락처를 입력해주세요.","error");if(!A.trim())return void g("동호수를 입력해주세요.","error");if(!$&&y.config.legalTerms?.trim())return void g("약관에 동의해주세요.","error");if(!U)return void g("서명을 해주세요.","error");S(!0);try{let e=K(D),t=O.current?.toDataURL("image/png")||"",s=await l.default.post("/ic/contracts",{configId:y.config.id,apartmentTypeId:D,selectedItems:e.map(e=>({sheetId:e.sheetId,rowId:e.rowId,columnId:e.columnId})),legalAgreed:!0,signatureData:t,customerName:M||void 0,customerPhone:_||void 0,unitNumber:A||void 0,specialNotes:E||void 0}),r=(0,l.extractData)(s);g("계약이 완료되었습니다!","success"),m.push(`/customer/integrated-contracts/${r.id}`)}catch(t){let e=t?.response?.data?.message;g(Array.isArray(e)?e[0]:e||"계약 생성에 실패했습니다.","error")}finally{S(!1)}};if(N)return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"w-full max-w-2xl mx-auto p-4 space-y-4",children:[1,2,3].map(e=>(0,t.jsx)("div",{className:"h-24 bg-white rounded-xl animate-pulse"},e))})});if(!y)return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,t.jsxs)(n.default,{className:"max-w-sm w-full text-center",children:[(0,t.jsx)(h.Home,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),(0,t.jsx)("p",{className:"font-bold text-gray-800",children:"통합 계약 설정을 찾을 수 없습니다"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"행사 정보를 확인해주세요."})]})});let Z=D?K(D):[],ee=["타입 선택","옵션 선택","서명"],et="type"===C?0:"select"===C?1:2;return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"max-w-2xl mx-auto p-4 space-y-4",children:[(0,t.jsxs)("button",{onClick:()=>{"sign"===C?I("select"):"select"===C&&y&&y.apartmentTypes.length>1?I("type"):m.back()},className:"flex items-center gap-1 text-sm text-gray-500 hover:text-gray-700",children:[(0,t.jsx)(x,{className:"w-4 h-4"}),"sign"===C?"옵션 선택으로":"뒤로"]}),y.apartmentTypes.length>1&&(0,t.jsx)("div",{className:"flex items-center gap-2 text-xs",children:ee.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:`flex items-center gap-1.5 ${s<=et?"text-blue-600 font-semibold":"text-gray-400"}`,children:[(0,t.jsx)("span",{className:`w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold ${s<et?"bg-blue-600 text-white":s===et?"bg-blue-100 text-blue-600 ring-2 ring-blue-600":"bg-gray-200 text-gray-400"}`,children:s<et?"✓":s+1}),e]}),s<ee.length-1&&(0,t.jsx)(p.ChevronRight,{className:"w-3 h-3 text-gray-300"})]},e))}),"type"===C&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:y.config.event?.name||"옵션 계약"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"계약 타입을 선택해주세요"})]}),(0,t.jsx)("div",{className:"space-y-3",children:y.apartmentTypes.map(e=>(0,t.jsx)("button",{onClick:()=>H(e.id),className:`w-full p-4 rounded-xl border-2 text-left transition-all ${D===e.id?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 hover:border-gray-300 bg-white"}`,children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${D===e.id?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:D===e.id&&(0,t.jsx)(u,{className:"w-3.5 h-3.5 text-white"})}),(0,t.jsx)("span",{className:`font-medium ${D===e.id?"text-blue-700":"text-gray-800"}`,children:e.name})]}),(0,t.jsx)(p.ChevronRight,{className:`w-4 h-4 ${D===e.id?"text-blue-500":"text-gray-300"}`})]})},e.id))}),(0,t.jsxs)(i.default,{fullWidth:!0,size:"lg",disabled:!D,onClick:()=>I("select"),children:["다음",(0,t.jsx)(p.ChevronRight,{className:"w-5 h-5 ml-1"})]})]}),"select"===C&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"옵션 선택"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"원하시는 품목을 선택해주세요"})]}),(0,t.jsx)(c.default,{partners:y.partners,selectedRows:w.map(e=>({sheetId:e.sheetId,rowId:e.rowId})),onToggleRow:(e,t,s,r,a)=>{k(l=>l.find(s=>s.sheetId===e&&s.rowId===t)?l.filter(s=>s.sheetId!==e||s.rowId!==t):[...l,{sheetId:e,rowId:t,optionName:s,categoryName:r,partnerName:a}])},selectedTypeId:D}),(0,t.jsxs)("div",{className:"sticky bottom-4 z-10 flex gap-3",children:[(0,t.jsxs)(i.default,{variant:"outline",size:"lg",className:"flex-1 shadow-lg bg-white",onClick:()=>m.push("/customer/integrated-contracts"),children:["계약 목록보기",w.length>0&&(0,t.jsx)("span",{className:"ml-1.5 bg-blue-100 text-blue-600 text-xs px-1.5 py-0.5 rounded-full",children:w.length})]}),(0,t.jsx)(i.default,{size:"lg",className:"flex-1 shadow-lg",disabled:0===w.length,onClick:()=>I("sign"),children:"계약 하기"})]})]}),"sign"===C&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"계약 서명"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"내용을 확인하고 서명해주세요"})]}),D&&y.apartmentTypes.length>1&&(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl px-4 py-3",children:[(0,t.jsx)("p",{className:"text-xs text-blue-500 font-medium",children:"선택 타입"}),(0,t.jsx)("p",{className:"text-sm font-bold text-blue-700",children:y.apartmentTypes.find(e=>e.id===D)?.name})]}),D&&Z.length>0&&(0,t.jsx)(n.default,{children:(0,t.jsx)(o,{items:Z,paymentStages:y.config.paymentStages||[]})}),(0,t.jsxs)(n.default,{children:[(0,t.jsx)("h3",{className:"font-bold text-gray-800 mb-3",children:"계약자 정보"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["이름 ",(0,t.jsx)("span",{className:"text-error",children:"*"})]}),(0,t.jsx)("input",{type:"text",value:M,onChange:e=>R(e.target.value),placeholder:"이름을 입력해주세요",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["연락처 ",(0,t.jsx)("span",{className:"text-error",children:"*"})]}),(0,t.jsx)("input",{type:"tel",value:_,onChange:e=>{let t;z((t=e.target.value.replace(/[^0-9]/g,"")).length<=3?t:t.length<=7?`${t.slice(0,3)}-${t.slice(3)}`:`${t.slice(0,3)}-${t.slice(3,7)}-${t.slice(7,11)}`)},placeholder:"010-0000-0000",maxLength:13,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["동호수 ",(0,t.jsx)("span",{className:"text-error",children:"*"})]}),(0,t.jsx)("input",{type:"text",value:A,onChange:e=>L(e.target.value),placeholder:"예: 101동 1201호",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),y.config.legalTerms?.trim()&&(0,t.jsxs)(n.default,{children:[(0,t.jsx)("h3",{className:"font-bold text-gray-800 mb-2",children:"약관"}),(0,t.jsx)("div",{className:"max-h-32 overflow-y-auto text-xs text-gray-500 bg-gray-50 rounded-lg p-3 mb-3 whitespace-pre-wrap",children:y.config.legalTerms}),(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:$,onChange:e=>P(e.target.checked),className:"w-5 h-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"약관에 동의합니다"})]})]}),(0,t.jsxs)(n.default,{children:[(0,t.jsx)("h3",{className:"font-bold text-gray-800 mb-2",children:"특이사항"}),(0,t.jsx)("textarea",{value:E,onChange:e=>B(e.target.value),placeholder:"특이사항이 있으면 입력해주세요 (선택)",rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})]}),(0,t.jsxs)(n.default,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("h3",{className:"font-bold text-gray-800",children:"서명"}),U&&(0,t.jsx)("button",{onClick:()=>{let e=O.current;if(!e)return;let t=e.getContext("2d");t&&t.clearRect(0,0,e.width,e.height),X(!1)},className:"text-xs text-error hover:text-error",children:"지우기"})]}),(0,t.jsx)("canvas",{ref:O,width:350,height:150,className:"w-full border-2 border-dashed border-gray-300 rounded-xl bg-white cursor-crosshair touch-none",onMouseDown:q,onMouseMove:G,onMouseUp:J,onMouseLeave:J,onTouchStart:q,onTouchMove:G,onTouchEnd:J}),!U&&(0,t.jsx)("p",{className:"text-xs text-gray-400 text-center mt-2",children:"위 영역에 서명해주세요"})]}),(0,t.jsxs)(i.default,{fullWidth:!0,size:"lg",onClick:Q,loading:T,disabled:!$&&!!y.config.legalTerms?.trim()||!D||!U||!M.trim()||!_.trim()||!A.trim(),children:[(0,t.jsx)(u,{className:"w-5 h-5 mr-2"}),"계약 완료"]})]})]})})}e.s(["default",()=>g],70255)}]);