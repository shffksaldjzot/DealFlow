(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31782,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(43531);let l=(0,e.i(75254).default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var r=e.i(7233),i=e.i(20312);function n({optionName:e,price:t,popupContent:n,selected:c,onSelect:d,onDetail:o}){let{image:x}=n?(0,i.parsePopupContent)(n):{image:null};return(0,s.jsxs)("div",{className:`flex-shrink-0 w-[140px] rounded-xl border-2 overflow-hidden transition-all ${c?"border-blue-500 bg-blue-50 shadow-md shadow-blue-100":"border-gray-200 bg-white hover:border-gray-300 hover:shadow-sm"}`,children:[(0,s.jsxs)("div",{className:"relative h-24 bg-gray-100 flex items-center justify-center overflow-hidden cursor-pointer",onClick:o||d,children:[x?(0,s.jsx)("img",{src:x,alt:e,className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"text-gray-300 text-xs",children:"No Image"}),c&&(0,s.jsx)("div",{className:"absolute top-1.5 right-1.5 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:(0,s.jsx)(a.Check,{className:"w-3 h-3 text-white"})}),n&&o&&(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),o()},className:"absolute top-1.5 left-1.5 w-6 h-6 bg-white/80 backdrop-blur rounded-full flex items-center justify-center hover:bg-white",children:(0,s.jsx)(l,{className:"w-3.5 h-3.5 text-gray-500"})})]}),(0,s.jsxs)("div",{className:"p-2.5",children:[(0,s.jsx)("p",{className:`text-xs font-medium line-clamp-2 leading-tight ${c?"text-blue-700":"text-gray-800"}`,children:e}),void 0!==t&&(0,s.jsx)("p",{className:`text-xs mt-1 font-semibold ${c?"text-blue-600":"text-gray-600"}`,children:(0,i.formatPrice)(t)}),(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),d?.()},className:`w-full mt-2 py-1.5 rounded-lg text-xs font-semibold transition-colors ${c?"bg-blue-500 text-white":"bg-gray-100 text-gray-600 hover:bg-blue-50 hover:text-blue-600"}`,children:c?(0,s.jsxs)("span",{className:"flex items-center justify-center gap-1",children:[(0,s.jsx)(a.Check,{className:"w-3 h-3"})," 선택됨"]}):(0,s.jsxs)("span",{className:"flex items-center justify-center gap-1",children:[(0,s.jsx)(r.Plus,{className:"w-3 h-3"})," 추가하기"]})})]})]})}var c=e.i(37727),d=e.i(59544);function o({isOpen:e,onClose:t,optionName:l,popupContent:n,price:o,selected:x,onSelect:m}){if(!e)return null;let{text:u,image:h}=(0,i.parsePopupContent)(n);return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end justify-center",onClick:t,children:(0,s.jsxs)("div",{className:"bg-white w-full max-w-lg rounded-t-2xl max-h-[85vh] overflow-y-auto animate-slide-up",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"flex justify-center pt-3 pb-1",children:(0,s.jsx)("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),h&&(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:h,alt:l,className:"w-full max-h-64 object-cover"}),(0,s.jsx)("button",{onClick:t,className:"absolute top-3 right-3 w-8 h-8 bg-black/40 backdrop-blur rounded-full flex items-center justify-center",children:(0,s.jsx)(c.X,{className:"w-5 h-5 text-white"})})]}),(0,s.jsxs)("div",{className:"p-5 space-y-4",children:[!h&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:l}),(0,s.jsx)("button",{onClick:t,className:"p-1.5 hover:bg-gray-100 rounded-lg",children:(0,s.jsx)(c.X,{className:"w-5 h-5 text-gray-400"})})]}),h&&(0,s.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:l}),void 0!==o&&(0,s.jsx)("p",{className:"text-xl font-bold text-blue-600",children:(0,i.formatPrice)(o)}),u&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-gray-500 mb-1.5",children:"시공범위"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-wrap leading-relaxed",children:u})]}),m&&(0,s.jsx)(d.default,{fullWidth:!0,size:"lg",variant:x?"outline":"primary",onClick:()=>{m(),t()},children:x?(0,s.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(a.Check,{className:"w-5 h-5"})," 선택 해제"]}):(0,s.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(r.Plus,{className:"w-5 h-5"})," 추가하기"]})})]})]})})}function x({partners:e,selectedRows:a,onToggleRow:r,selectedTypeId:i}){let[c,d]=(0,t.useState)(null),x=(e,s)=>a.some(t=>t.sheetId===e&&t.rowId===s),m=[];return e.forEach(e=>{e.categories.forEach(s=>{m.push({id:s.sheetId,name:s.categoryName,partnerName:e.partnerName,partnerId:e.partnerId,options:s.options,columns:s.columns})})}),(0,s.jsxs)("div",{className:"space-y-6",children:[m.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)("h4",{className:"text-base font-bold text-gray-800",children:e.name}),(0,s.jsx)("button",{className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)(l,{className:"w-4 h-4"})})]}),e.options.length>0?(0,s.jsx)("div",{className:"flex gap-3 overflow-x-auto pb-2 -mx-1 px-1 scrollbar-hide",children:e.options.map(t=>{let a=((e,s)=>{if(!i)return;let t=s.find(e=>e.apartmentTypeId===i);if(t){let s=e.cellValues?.[t.id];if(void 0!==s&&""!==s&&"0"!==s){let e=Number(String(s).replace(/,/g,""));if(e>0)return e}let a=e.prices?.[t.id];if(a&&a>0)return a}for(let t of s)if("amount"===t.columnType||!t.columnType){let s=e.prices?.[t.id];if(s&&s>0)return s;let a=e.cellValues?.[t.id];if(a){let e=Number(String(a).replace(/,/g,""));if(e>0)return e}}})(t,e.columns),l=x(e.id,t.rowId);return(0,s.jsx)(n,{optionName:t.optionName,price:a,popupContent:t.popupContent,selected:l,onSelect:()=>r(e.id,t.rowId,t.optionName,e.name,e.partnerName),onDetail:t.popupContent?()=>d({optionName:t.optionName,popupContent:t.popupContent,price:a,sheetId:e.id,rowId:t.rowId,categoryName:e.name,partnerName:e.partnerName}):void 0},t.rowId)})}):(0,s.jsx)("div",{className:"text-center py-8 text-gray-400 text-sm",children:"등록된 옵션이 없습니다."})]},e.id)),0===m.length&&(0,s.jsx)("div",{className:"text-center py-12 text-gray-400 text-sm",children:"등록된 품목이 없습니다."}),c&&(0,s.jsx)(o,{isOpen:!0,onClose:()=>d(null),optionName:c.optionName,popupContent:c.popupContent,price:c.price,selected:x(c.sheetId,c.rowId),onSelect:()=>{r(c.sheetId,c.rowId,c.optionName,c.categoryName,c.partnerName)}})]})}e.s(["default",()=>x],31782)},86536,e=>{"use strict";let s=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],86536)},56909,e=>{"use strict";let s=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>s],56909)},7233,e=>{"use strict";let s=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],7233)},20312,e=>{"use strict";function s(e){let s="\n---IMAGE---\n",t=e.indexOf(s);return -1===t?{text:e,image:null}:{text:e.slice(0,t),image:e.slice(t+s.length)}}function t(e){if(null==e||""===e)return"-";let s="number"==typeof e?e:Number(String(e).replace(/,/g,""));return!s||isNaN(s)?"-":`${s.toLocaleString("ko-KR")}원`}e.s(["formatPrice",()=>t,"parsePopupContent",()=>s])},54508,31278,e=>{"use strict";var s=e.i(43476),t=e.i(88699),a=e.i(27612),l=e.i(20312);function r({optionName:e,popupContent:r,apartmentTypeId:i,price:n,prices:c,cellValues:d,columns:o,apartmentTypes:x,onEdit:m,onDelete:u}){let{image:h}=r?(0,l.parsePopupContent)(r):{image:null},p=i?x.find(e=>e.id===i)?.name:null;return(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden hover:shadow-sm transition-shadow",children:(0,s.jsxs)("div",{className:"flex",children:[h&&(0,s.jsx)("div",{className:"w-20 h-20 flex-shrink-0 bg-gray-100",children:(0,s.jsx)("img",{src:h,alt:e,className:"w-full h-full object-cover"})}),(0,s.jsx)("div",{className:"flex-1 p-3 min-w-0",children:(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-800 truncate",children:e}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[p&&(0,s.jsx)("span",{className:"text-xs bg-indigo-50 text-indigo-600 px-2 py-0.5 rounded-full font-medium",children:p}),null!=n&&n>0&&(0,s.jsx)("span",{className:"text-xs font-semibold text-gray-700",children:(0,l.formatPrice)(n)})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[(0,s.jsx)("button",{onClick:m,className:"p-1.5 rounded-lg hover:bg-gray-100 text-gray-400 hover:text-gray-600",children:(0,s.jsx)(t.Pencil,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{onClick:u,className:"p-1.5 rounded-lg hover:bg-red-50 text-gray-400 hover:text-red-500",children:(0,s.jsx)(a.Trash2,{className:"w-3.5 h-3.5"})})]})]})})]})})}e.s(["default",()=>r],54508);let i=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>i],31278)},27612,e=>{"use strict";let s=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>s],27612)},74886,e=>{"use strict";let s=(0,e.i(75254).default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>s],74886)},88699,e=>{"use strict";let s=(0,e.i(75254).default)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>s],88699)},58524,e=>{"use strict";let s=(0,e.i(75254).default)("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);e.s(["Link2",()=>s],58524)},52481,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(9165),l=e.i(39964),r=e.i(59544),i=e.i(96640),n=e.i(32098),c=e.i(22706),d=e.i(88840),o=e.i(7233),x=e.i(27612),m=e.i(63209);function u({stages:e,onChange:t,disabled:a}){let l=e.reduce((e,s)=>e+s.ratio,0),i=.01>Math.abs(l-100);return(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"결제 단계"}),!a&&(0,s.jsxs)(r.default,{variant:"ghost",size:"sm",onClick:()=>{let s=100-l;t([...e,{name:"",ratio:s>0?s:0}])},children:[(0,s.jsx)(o.Plus,{className:"w-4 h-4 mr-1"}),"단계 추가"]})]}),0===e.length?(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"일시불 (단계 미설정)"}):(0,s.jsx)("div",{className:"space-y-2",children:e.map((l,r)=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"text",value:l.name,onChange:s=>{var a;let l;return a=s.target.value,void((l=[...e])[r]={...l[r],name:a},t(l))},placeholder:`${r+1}차`,disabled:a,className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-50"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("input",{type:"number",value:l.ratio,onChange:s=>{var a;let l;return a=s.target.value,void((l=[...e])[r]={...l[r],ratio:Number(a)||0},t(l))},min:0,max:100,disabled:a,className:"w-20 px-3 py-2 border border-gray-200 rounded-lg text-sm text-right focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-50"}),(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"%"})]}),!a&&(0,s.jsx)("button",{onClick:()=>{t(e.filter((e,s)=>s!==r))},className:"p-1.5 rounded-lg hover:bg-error-light text-gray-400 hover:text-error transition-colors",children:(0,s.jsx)(x.Trash2,{className:"w-4 h-4"})})]},r))}),e.length>0&&(0,s.jsxs)("div",{className:`flex items-center gap-2 text-sm ${i?"text-success":"text-error"}`,children:[!i&&(0,s.jsx)(m.AlertCircle,{className:"w-4 h-4"}),(0,s.jsxs)("span",{children:["합계: ",l,"% ",!i&&"(100%가 되어야 합니다)"]})]})]})}var h=e.i(31782),p=e.i(54508),g=e.i(56909),f=e.i(64659),y=e.i(55900),j=e.i(74886),N=e.i(43531),b=e.i(58524),v=e.i(7486),w=e.i(94918),k=e.i(86536),C=e.i(75254);let S=(0,C.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var T=e.i(88699);let z=(0,C.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var $=e.i(31278);function I({eventId:e,backHref:m}){let C,I,{toast:M}=(0,d.useToast)(),[P,E]=(0,t.useState)(null),[V,D]=(0,t.useState)(null),[F,O]=(0,t.useState)(!0),[R,H]=(0,t.useState)(!1),[U,_]=(0,t.useState)([]),[K,L]=(0,t.useState)(""),[A,q]=(0,t.useState)(""),[B,W]=(0,t.useState)([]),[X,G]=(0,t.useState)(""),[J,Q]=(0,t.useState)(null),[Y,Z]=(0,t.useState)([]),[ee,es]=(0,t.useState)([]),[et,ea]=(0,t.useState)(null),[el,er]=(0,t.useState)(null),[ei,en]=(0,t.useState)(!1),[ec,ed]=(0,t.useState)(""),[eo,ex]=(0,t.useState)(!1),[em,eu]=(0,t.useState)(!1),[eh,ep]=(0,t.useState)(!1),[eg,ef]=(0,t.useState)(!1),[ey,ej]=(0,t.useState)(!1),[eN,eb]=(0,t.useState)({types:!0,stages:!0,terms:!1,sheets:!0}),ev=e=>{eb(s=>({...s,[e]:!s[e]}))},ew=(0,t.useCallback)(async()=>{try{let[s,t]=await Promise.all([a.default.get(`/ic/configs/event/${e}`).catch(()=>null),a.default.get(`/events/${e}`).catch(()=>null)]),l=t?.data?.data;D(l);let r=await a.default.get(`/events/${e}/participants`).catch(()=>null);Z(r?.data?.data||[]);let i=s?.data?.data;if(i){E(i),_(i.paymentStages||[]),L(i.legalTerms||""),q(i.specialNotes||""),W(i.apartmentTypes||[]);let e=await a.default.get(`/ic/configs/${i.id}/sheets`).catch(()=>null);es(e?.data?.data||[])}}catch{M("데이터를 불러올 수 없습니다.","error")}finally{O(!1)}},[e,M]);(0,t.useEffect)(()=>{ew()},[ew]);let ek=async()=>{try{let s=`1. 계약일 기준 14일 이후에는 취소가 불가능합니다.
2. 본 계약은 해당 옵션 공사에 대한 계약이며, 별도 계약 품목은 보장하지 않습니다.
3. 공사 일정은 입주 일정에 따라 변경될 수 있습니다.
4. 계약 후 옵션 변경은 공사 착수 전까지만 가능합니다.`,t=(await a.default.post("/ic/configs",{eventId:e,paymentStages:[{name:"계약금",ratio:20},{name:"중도금",ratio:40},{name:"잔금",ratio:40}],legalTerms:s})).data.data;E(t),_(t.paymentStages||[]),L(t.legalTerms||""),q(t.specialNotes||""),W(t.apartmentTypes||[]),M("통합 계약 설정이 생성되었습니다.","success")}catch{M("설정 생성에 실패했습니다.","error")}},eC=async()=>{if(P){H(!0);try{let e=await a.default.patch(`/ic/configs/${P.id}`,{paymentStages:U,legalTerms:K,specialNotes:A});E(e.data.data),M("설정이 저장되었습니다.","success")}catch{M("저장에 실패했습니다.","error")}finally{H(!1)}}},eS=async e=>{if(P)try{let s=await a.default.patch(`/ic/configs/${P.id}`,{status:e});E(s.data.data),M(`상태가 "${e}"로 변경되었습니다.`,"success")}catch{M("상태 변경에 실패했습니다.","error")}},eT=async()=>{if(P){ep(!0);try{await a.default.delete(`/ic/configs/${P.id}`),E(null),eu(!1),M("통합 계약 설정이 삭제되었습니다.","success")}catch{M("설정 삭제에 실패했습니다.","error")}finally{ep(!1)}}},ez=async()=>{if(P&&X.trim())try{let e=await a.default.post(`/ic/configs/${P.id}/apartment-types`,{name:X.trim(),sortOrder:B.length});W(s=>[...s,e.data.data]),G(""),M("행사제목이 추가되었습니다.","success")}catch{M("행사제목 추가에 실패했습니다.","error")}},e$=async()=>{if(P&&J)try{await a.default.patch(`/ic/configs/${P.id}/apartment-types/${J.id}`,{name:J.name}),W(e=>e.map(e=>e.id===J.id?{...e,name:J.name}:e)),Q(null),M("행사제목이 수정되었습니다.","success")}catch{M("행사제목 수정에 실패했습니다.","error")}},eI=async e=>{if(P)try{await a.default.delete(`/ic/configs/${P.id}/apartment-types/${e}`),W(s=>s.filter(s=>s.id!==e)),M("행사제목이 삭제되었습니다.","success")}catch{M("행사제목 삭제에 실패했습니다.","error")}},eM=async()=>{if(P&&ec.trim()){ex(!0);try{let e=await a.default.post("/ic/sheets",{configId:P.id,categoryName:ec.trim()});es(s=>[...s,e.data.data]),ed(""),en(!1),M("시트가 생성되었습니다.","success")}catch{M("시트 생성에 실패했습니다.","error")}finally{ex(!1)}}},eP=async(e,s)=>{if(P)try{await a.default.patch(`/ic/configs/${P.id}/sheets/${e}`,{status:s}),es(t=>t.map(t=>t.id===e?{...t,status:s}:t)),M("시트 상태가 변경되었습니다.","success")}catch{M("상태 변경에 실패했습니다.","error")}},eE=async()=>{if(el&&P)try{await a.default.patch(`/ic/configs/${P.id}/sheets/${el.id}`,{status:"inactive"}),es(e=>e.filter(e=>e.id!==el.id)),er(null),et===el.id&&ea(null),M("시트가 삭제되었습니다.","success")}catch{M("시트 삭제에 실패했습니다.","error")}},[eV,eD]=(0,t.useState)(!1),eF=async()=>{if(P&&0!==ee.length){eD(!0);try{await Promise.all(ee.map(e=>a.default.patch(`/ic/configs/${P.id}/sheets/${e.id}/commission`,{commissionRate:e.commissionRate||0}))),M("모든 수수료율이 저장되었습니다.","success")}catch{M("수수료율 저장에 실패했습니다.","error")}finally{eD(!1)}}},eO=V?.inviteCode?`${window.location.origin}/events/${V.inviteCode}/options`:"";return F?(0,s.jsxs)("div",{children:[(0,s.jsx)(c.default,{title:"통합 계약 설정",backHref:m}),(0,s.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,s.jsx)("div",{className:"animate-pulse h-24 bg-white rounded-xl"},e))})]}):P?(0,s.jsxs)("div",{children:[R&&(0,s.jsx)("div",{className:"fixed inset-0 z-[200] bg-black/40 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl px-8 py-6 shadow-2xl flex items-center gap-4",children:[(0,s.jsx)($.Loader2,{className:"w-6 h-6 text-blue-600 animate-spin"}),(0,s.jsx)("span",{className:"text-base font-medium text-gray-800",children:"저장 중..."})]})}),(0,s.jsx)(c.default,{title:"통합 계약 설정",backHref:m,actions:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(i.default,{status:P.status}),({draft:[{label:"활성화",next:"active",variant:"primary"}],active:[{label:"마감",next:"closed",variant:"danger"}],closed:[{label:"다시 활성화",next:"active",variant:"outline"}]})[P.status]?.map(e=>(0,s.jsx)(r.default,{size:"sm",variant:e.variant,onClick:()=>eS(e.next),children:e.label},e.next)),(0,s.jsxs)(r.default,{size:"sm",variant:"danger",onClick:()=>eu(!0),children:[(0,s.jsx)(x.Trash2,{className:"w-3.5 h-3.5 mr-1"}),"삭제"]})]})}),eO&&(0,s.jsx)(l.default,{className:"mb-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(b.Link2,{className:"w-5 h-5 text-blue-500 flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"고객 옵션 선택 링크"}),(0,s.jsx)("p",{className:"text-xs text-gray-600 font-mono bg-gray-50 px-2 py-1.5 rounded-lg truncate",children:eO})]}),(0,s.jsx)(r.default,{size:"sm",variant:"outline",onClick:()=>{eO&&(navigator.clipboard.writeText(eO),ej(!0),M("링크가 복사되었습니다.","success"),setTimeout(()=>ej(!1),2e3))},children:ey?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Check,{className:"w-3.5 h-3.5 mr-1"})," 복사됨"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.Copy,{className:"w-3.5 h-3.5 mr-1"})," 복사"]})}),(0,s.jsx)("a",{href:eO,target:"_blank",rel:"noopener noreferrer",children:(0,s.jsx)(r.default,{size:"sm",variant:"outline",children:(0,s.jsx)(z,{className:"w-3.5 h-3.5"})})}),(0,s.jsxs)(r.default,{size:"sm",variant:"outline",onClick:()=>ef(!0),children:[(0,s.jsx)(k.Eye,{className:"w-3.5 h-3.5 mr-1"}),"미리보기"]})]})}),(0,s.jsxs)(l.default,{className:"mb-4",children:[(0,s.jsxs)("button",{className:"w-full flex items-center justify-between",onClick:()=>ev("types"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Building2,{className:"w-5 h-5 text-indigo-500"}),(0,s.jsx)("h3",{className:"font-semibold text-gray-800",children:"행사제목"}),(0,s.jsxs)("span",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-0.5 rounded-full",children:[B.length,"개"]})]}),eN.types?(0,s.jsx)(y.ChevronUp,{className:"w-4 h-4 text-gray-400"}):(0,s.jsx)(f.ChevronDown,{className:"w-4 h-4 text-gray-400"})]}),eN.types&&(0,s.jsxs)("div",{className:"mt-4 space-y-3",children:[0===B.length?(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"등록된 행사제목이 없습니다."}):(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:B.map(e=>(0,s.jsx)("div",{className:"border border-gray-200 rounded-lg p-3 flex items-center justify-between",children:J?.id===e.id?(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,s.jsx)("input",{type:"text",value:J.name,onChange:e=>Q({...J,name:e.target.value}),className:"flex-1 px-2 py-1 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyDown:e=>"Enter"===e.key&&e$()}),(0,s.jsx)(r.default,{size:"sm",onClick:e$,children:"저장"}),(0,s.jsx)(r.default,{size:"sm",variant:"outline",onClick:()=>Q(null),children:"취소"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"w-6 h-6 rounded-lg bg-indigo-100 text-indigo-600 flex items-center justify-center text-xs font-bold",children:e.sortOrder+1}),(0,s.jsx)("span",{className:"font-medium text-gray-800",children:e.name}),e.floorPlanFileId&&(0,s.jsx)("span",{className:"text-[10px] bg-success-light text-success px-1.5 py-0.5 rounded-full",children:"평면도"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("button",{onClick:()=>Q({id:e.id,name:e.name}),className:"p-1.5 rounded-lg hover:bg-gray-100 text-gray-400 hover:text-gray-600",children:(0,s.jsx)(T.Pencil,{className:"w-3.5 h-3.5"})}),(0,s.jsx)("button",{onClick:()=>eI(e.id),className:"p-1.5 rounded-lg hover:bg-error-light text-gray-400 hover:text-error",children:(0,s.jsx)(x.Trash2,{className:"w-3.5 h-3.5"})})]})]})},e.id))}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"text",value:X,onChange:e=>G(e.target.value),placeholder:"예: 래미안 옵션계약, 힐스테이트 인테리어",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyDown:e=>"Enter"===e.key&&ez()}),(0,s.jsxs)(r.default,{size:"sm",onClick:ez,disabled:!X.trim(),children:[(0,s.jsx)(o.Plus,{className:"w-4 h-4 mr-1"}),"추가"]})]})]})]}),(0,s.jsxs)(l.default,{className:"mb-4",children:[(0,s.jsxs)("button",{className:"w-full flex items-center justify-between",onClick:()=>ev("stages"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(w.FileSpreadsheet,{className:"w-5 h-5 text-success"}),(0,s.jsx)("h3",{className:"font-semibold text-gray-800",children:"결제 단계"}),(0,s.jsx)("span",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-0.5 rounded-full",children:0===U.length?"일시불":`${U.length}단계`})]}),eN.stages?(0,s.jsx)(y.ChevronUp,{className:"w-4 h-4 text-gray-400"}):(0,s.jsx)(f.ChevronDown,{className:"w-4 h-4 text-gray-400"})]}),eN.stages&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(u,{stages:U,onChange:_})})]}),(0,s.jsxs)(l.default,{className:"mb-4",children:[(0,s.jsxs)("button",{className:"w-full flex items-center justify-between",onClick:()=>ev("terms"),children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-800",children:"약관 · 특약사항"}),eN.terms?(0,s.jsx)(y.ChevronUp,{className:"w-4 h-4 text-gray-400"}):(0,s.jsx)(f.ChevronDown,{className:"w-4 h-4 text-gray-400"})]}),eN.terms&&(0,s.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"약관"}),(0,s.jsx)("textarea",{value:K,onChange:e=>L(e.target.value),rows:5,className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-y",placeholder:"고객이 계약 시 동의할 약관 내용을 입력하세요."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 block mb-1.5",children:"특약사항"}),(0,s.jsx)("textarea",{value:A,onChange:e=>q(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 resize-y",placeholder:"추가 특약사항이 있으면 입력하세요."})]})]})]}),(0,s.jsxs)(r.default,{fullWidth:!0,size:"lg",onClick:eC,loading:R,className:"mb-6",children:[(0,s.jsx)(g.Save,{className:"w-5 h-5 mr-2"}),"설정 저장"]}),ee.length>0&&(0,s.jsxs)(l.default,{className:"mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(w.FileSpreadsheet,{className:"w-5 h-5 text-amber-500"}),(0,s.jsx)("h3",{className:"font-semibold text-gray-800",children:"품목 설정하기"})]}),(0,s.jsx)("div",{className:"border-b-2 border-gray-800 pb-2 mb-1",children:(0,s.jsxs)("div",{className:"grid grid-cols-[1fr_80px_60px_90px] gap-2 text-xs font-bold text-gray-700",children:[(0,s.jsx)("span",{children:"품목"}),(0,s.jsx)("span",{children:"업체명"}),(0,s.jsx)("span",{className:"text-center",children:"계약건"}),(0,s.jsx)("span",{className:"text-right",children:"집계"})]})}),ee.flatMap(e=>(e.rows||[]).map(t=>(Object.values(t.prices||{}).reduce((e,s)=>e+(Number(s)||0),0),(0,s.jsxs)("div",{className:"grid grid-cols-[1fr_80px_60px_90px] gap-2 items-center py-2.5 border-b border-gray-100 text-sm",children:[(0,s.jsx)("span",{className:"text-gray-800 truncate",children:t.optionName}),(0,s.jsx)("span",{className:"text-gray-600 text-xs truncate",children:e.partner?.name||"—"}),(0,s.jsx)("span",{className:"text-gray-600 text-xs text-center",children:"—"}),(0,s.jsx)("button",{onClick:()=>ea(et===e.id?null:e.id),className:"text-xs text-blue-600 bg-blue-50 hover:bg-blue-100 px-2.5 py-1 rounded-lg font-medium text-right transition-colors",children:"상세보기"})]},`${e.id}-${t.id}`)))),0===ee.flatMap(e=>e.rows||[]).length&&(0,s.jsx)("p",{className:"text-sm text-gray-400 text-center py-4",children:"등록된 품목이 없습니다."})]}),(0,s.jsxs)(l.default,{children:[(0,s.jsxs)("button",{className:"w-full flex items-center justify-between",onClick:()=>ev("sheets"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(w.FileSpreadsheet,{className:"w-5 h-5 text-amber-500"}),(0,s.jsx)("h3",{className:"font-semibold text-gray-800",children:"협력업체 시트"}),(0,s.jsxs)("span",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-0.5 rounded-full",children:[ee.length,"개"]})]}),eN.sheets?(0,s.jsx)(y.ChevronUp,{className:"w-4 h-4 text-gray-400"}):(0,s.jsx)(f.ChevronDown,{className:"w-4 h-4 text-gray-400"})]}),eN.sheets&&(0,s.jsxs)("div",{className:"mt-4 space-y-3",children:[(C=new Set(ee.map(e=>e.partner?.id).filter(Boolean)),0===(I=Y.filter(e=>"approved"===e.status&&e.organization?.type==="partner").filter(e=>!C.has(e.organizationId))).length?null:(0,s.jsxs)("div",{className:"bg-warning-light border border-amber-200 rounded-xl p-3",children:[(0,s.jsxs)("p",{className:"text-xs font-semibold text-warning mb-1",children:["시트 미제출 업체 (",I.length,")"]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1.5",children:I.map(e=>(0,s.jsx)("span",{className:"text-xs bg-yellow-100 text-warning px-2 py-0.5 rounded-full",children:e.organization?.name||"업체"},e.id))})]})),ei?(0,s.jsxs)("div",{className:"border-2 border-dashed border-blue-300 rounded-xl p-4 bg-blue-50/30",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"새 시트 만들기"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"text",value:ec,onChange:e=>ed(e.target.value),placeholder:"카테고리명 (예: 마감재, 가전, 가구)",className:"flex-1 px-3 py-2 border border-gray-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyDown:e=>"Enter"===e.key&&eM(),autoFocus:!0}),(0,s.jsxs)(r.default,{size:"sm",onClick:eM,disabled:!ec.trim(),loading:eo,children:[(0,s.jsx)(N.Check,{className:"w-4 h-4 mr-1"}),"생성"]}),(0,s.jsx)(r.default,{size:"sm",variant:"outline",onClick:()=>{en(!1),ed("")},children:"취소"})]})]}):(0,s.jsxs)("button",{onClick:()=>en(!0),className:"w-full border-2 border-dashed border-gray-200 rounded-xl p-4 text-sm text-gray-500 hover:border-blue-400 hover:text-blue-600 hover:bg-blue-50/30 transition-colors flex items-center justify-center gap-2",children:[(0,s.jsx)(o.Plus,{className:"w-4 h-4"}),"새 시트 추가"]}),0!==ee.length||ei?ee.map(e=>(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between bg-gray-50/50",children:[(0,s.jsx)("div",{className:"flex items-center gap-3",children:(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium text-gray-800",children:e.categoryName}),(0,s.jsx)(i.default,{status:e.status})]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:[e.partner?.name||"업체"," · 열 ",e.columns?.length||0,"개 · 행 ",e.rows?.length||0,"개"]})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:["draft"===e.status&&(0,s.jsxs)(r.default,{size:"sm",variant:"outline",onClick:()=>eP(e.id,"active"),children:[(0,s.jsx)(k.Eye,{className:"w-3.5 h-3.5 mr-1"})," 활성화"]}),"active"===e.status&&(0,s.jsxs)(r.default,{size:"sm",variant:"outline",onClick:()=>eP(e.id,"inactive"),children:[(0,s.jsx)(S,{className:"w-3.5 h-3.5 mr-1"})," 비활성"]}),"inactive"===e.status&&(0,s.jsxs)(r.default,{size:"sm",variant:"outline",onClick:()=>eP(e.id,"active"),children:[(0,s.jsx)(k.Eye,{className:"w-3.5 h-3.5 mr-1"})," 재활성"]}),(0,s.jsx)("button",{onClick:()=>er(e),className:"p-2 rounded-lg hover:bg-error-light text-gray-400 hover:text-error",title:"시트 삭제",children:(0,s.jsx)(x.Trash2,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>ea(et===e.id?null:e.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-500",children:et===e.id?(0,s.jsx)(y.ChevronUp,{className:"w-4 h-4"}):(0,s.jsx)(f.ChevronDown,{className:"w-4 h-4"})})]})]}),(0,s.jsxs)("div",{className:"px-4 py-2 border-t border-gray-200 bg-white flex items-center gap-3",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:"수수료율"}),(0,s.jsx)("input",{type:"number",min:"0",max:"100",step:"0.1",value:e.commissionRate||0,onChange:s=>{let t=parseFloat(s.target.value)||0;es(s=>s.map(s=>s.id===e.id?{...s,commissionRate:t}:s))},className:"w-20 px-2 py-1 border border-gray-200 rounded-lg text-sm text-center focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"%"})]}),et===e.id&&(0,s.jsxs)("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[0===(e.rows||[]).length?(0,s.jsx)("p",{className:"text-sm text-gray-400 text-center py-4",children:"등록된 품목이 없습니다."}):(e.rows||[]).map(t=>(0,s.jsx)(p.default,{optionName:t.optionName,popupContent:t.popupContent,prices:t.prices||{},cellValues:t.cellValues,columns:(e.columns||[]).map(e=>({id:e.id,customName:e.customName||e.apartmentType?.name,columnType:e.columnType||"amount",apartmentTypeId:e.apartmentTypeId})),apartmentTypes:B,onEdit:()=>{},onDelete:()=>{}},t.id)),(0,s.jsxs)("p",{className:"text-xs text-gray-400 text-center pt-2",children:[(e.columns||[]).length,"열 · ",(e.rows||[]).length,"행"]})]})]},e.id)):(0,s.jsx)("p",{className:"text-sm text-gray-400 text-center py-4",children:"등록된 시트가 없습니다."}),ee.length>0&&(0,s.jsxs)(r.default,{fullWidth:!0,size:"lg",variant:"outline",onClick:eF,loading:eV,className:"mt-2",children:[(0,s.jsx)(g.Save,{className:"w-4 h-4 mr-2"}),"수수료율 일괄 저장"]})]})]}),(0,s.jsxs)(n.default,{isOpen:!!el,onClose:()=>er(null),title:"시트 삭제 확인",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:[(0,s.jsxs)("strong",{children:["“",el?.categoryName,"”"]})," 시트를 삭제하시겠습니까? 시트의 모든 데이터가 비활성화됩니다."]}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsx)(r.default,{variant:"outline",onClick:()=>er(null),children:"취소"}),(0,s.jsxs)(r.default,{variant:"danger",onClick:eE,children:[(0,s.jsx)(x.Trash2,{className:"w-4 h-4 mr-1"}),"삭제"]})]})]}),(0,s.jsx)(n.default,{isOpen:eg,onClose:()=>ef(!1),title:"고객 미리보기",size:"lg",children:(0,s.jsx)("div",{className:"max-h-[70vh] overflow-y-auto",children:0===ee.length?(0,s.jsx)("p",{className:"text-sm text-gray-400 text-center py-8",children:"등록된 시트가 없습니다."}):(0,s.jsx)(h.default,{partners:ee.filter(e=>"inactive"!==e.status).reduce((e,s)=>{let t=s.partner?.id||"unknown",a=e.find(e=>e.partnerId===t);return a||(a={partnerId:t,partnerName:s.partner?.name||"업체",categories:[]},e.push(a)),a.categories.push({sheetId:s.id,categoryName:s.categoryName,columns:(s.columns||[]).map(e=>({id:e.id,customName:e.customName||e.apartmentType?.name||"열",columnType:e.columnType||"amount",apartmentTypeId:e.apartmentTypeId})),options:(s.rows||[]).map(e=>({rowId:e.id,optionName:e.optionName,popupContent:e.popupContent,cellValues:e.cellValues||{},prices:e.prices||{}}))}),e},[]),selectedRows:[],onToggleRow:()=>{}})})}),(0,s.jsxs)(n.default,{isOpen:em,onClose:()=>eu(!1),title:"통합 계약 설정 삭제",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"통합 계약 설정을 삭제하시겠습니까? 모든 아파트 타입, 결제단계, 시트 데이터가 함께 삭제됩니다. 이 작업은 되돌릴 수 없습니다."}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,s.jsx)(r.default,{variant:"outline",onClick:()=>eu(!1),children:"취소"}),(0,s.jsxs)(r.default,{variant:"danger",onClick:eT,loading:eh,children:[(0,s.jsx)(x.Trash2,{className:"w-4 h-4 mr-1"}),"삭제"]})]})]})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)(c.default,{title:"통합 계약 설정",backHref:m}),(0,s.jsxs)(l.default,{className:"text-center py-12",children:[(0,s.jsx)(w.FileSpreadsheet,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"이 행사에 통합 계약 설정이 없습니다."}),(0,s.jsxs)(r.default,{onClick:ek,children:[(0,s.jsx)(o.Plus,{className:"w-4 h-4 mr-2"}),"통합 계약 설정 생성"]})]})]})}e.s(["default",()=>I],52481)}]);